<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tableau de bord des ventes WiFi Zone</title><script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-database-compat.min.js"></script><style>:root{--a:#0ff;--b:#f0f;--c:#0a0a1a;--d:#0ff;--e:rgba(255,255,255,.1);--f:rgba(20,20,40,.8)}:root.g{--a:#008080;--b:#800080;--c:#f0f0f0;--d:#333;--e:rgba(0,0,0,.1);--f:rgba(255,255,255,.8)}body{font-family:Orbitron,sans-serif;line-height:1.6;margin:0;padding:20px;background-color:var(--c);color:var(--d);transition:all .3s ease}.h{max-width:1200px;margin:0 auto;background-color:var(--f);padding:20px;border-radius:15px;box-shadow:0 0 20px rgba(0,255,255,.2)}h1,h2,h3{color:var(--a);text-shadow:0 0 10px rgba(0,255,255,.5)}form{margin-bottom:20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px}button,input,select{padding:10px;border:none;background-color:var(--e);color:var(--d);border-radius:5px}button{background-color:var(--a);cursor:pointer;transition:all .3s ease}button:hover{background-color:var(--b)}table{width:100%;border-collapse:separate;border-spacing:0 10px;margin-bottom:20px}td,th{padding:15px;text-align:left;background-color:var(--e)}th{background-color:var(--a);color:var(--c);cursor:pointer}#i{margin-top:20px;background-color:var(--f);border-radius:10px;padding:20px}#j{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}#j input{margin-bottom:10px;width:200px}#k{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}#l{font-size:1.2em;color:var(--d)}#m{display:flex;justify-content:space-between;margin-bottom:10px}#m input{width:calc(100%/8 - 10px)}.n{display:flex;justify-content:space-between;margin-bottom:20px}.o{width:48%;padding:10px;background-color:var(--a);color:var(--c);border:none;border-radius:5px;cursor:pointer;transition:all .3s ease}.o:hover{background-color:var(--b)}#p,#q{display:none}.r{margin-top:20px;background-color:var(--e);padding:15px;border-radius:10px}.r h3{color:var(--a);margin-top:0}#s{position:fixed;top:10px;right:10px;background:0 0;border:none;cursor:pointer;font-size:24px;z-index:1001;padding:5px;border-radius:50%;transition:background-color .3s ease}#s:hover{background-color:var(--e)}.t{display:flex;gap:10px;margin-bottom:10px}.t input{flex:1}.u{display:flex;flex-wrap:wrap;justify-content:space-between}.v{width:48%;margin-bottom:20px}.u{display:flex;flex-direction:column}.v{width:100%;margin-bottom:20px;overflow-x:auto}.v table{width:100%;min-width:300px}@media (min-width:768px){.u{flex-direction:row;flex-wrap:wrap;justify-content:space-between}.v{width:48%}}</style></head><body><button id="s" aria-label="Toggle theme">🌙</button><div id="w" class="h"><h1>Connexion</h1><form id="j"><input type="text" id="x" placeholder="Nom d'utilisateur" required> <input type="password" id="y" placeholder="Mot de passe" required> <button type="submit">Se connecter / S'inscrire</button></form></div><div id="z" class="h" style="display:none"><div id="k"><h1>Cyber Campus</h1><div id="l"></div></div><h2>Enregistrer une nouvelle opération</h2><form id="A"><input type="datetime-local" id="B" required><select id="C" required><option value="">Sélectionner un produit</option><option value="1H">1H</option><option value="2H">2H</option><option value="3H">3H</option><option value="1J">1J</option><option value="3J">3J</option><option value="7J">7J</option><option value="30J">30J</option><option value="1G">1G</option><option value="5G">5G</option><option value="10G">10G</option><option value="25G">25G</option><option value="1H Pro">1H Pro</option><option value="2H Pro">2H Pro</option><option value="3H Pro">3H Pro</option><option value="1J Pro">1J Pro</option><option value="3J Pro">3J Pro</option><option value="7J Pro">7J Pro</option><option value="30J Pro">30J Pro</option></select> <input type="number" id="D" placeholder="Stock Initial" required> <input type="number" id="E" placeholder="Approvisionnement" required> <input type="number" id="F" placeholder="Ventes" required> <input type="number" id="G" placeholder="Stock Final" readonly> <input type="number" id="H" placeholder="Prix de Vente" readonly> <button type="submit">Ajouter</button></form><h2>Détails des stocks</h2><div class="t"><input type="datetime-local" id="I"> <input type="datetime-local" id="J"> <button id="K">Filtrer</button></div><div class="u"><div class="v"><h3>Stock Lite (1H, 2H, 3H)</h3><div class="L"><table id="M"><thead><tr><th data-sort="C">Produit</th><th data-sort="G">Stock Final</th><th data-sort="B">Date et Heure</th></tr></thead><tbody></tbody></table></div></div><div class="v"><h3>Stock Journalier (1J, 3J, 7J, 30J)</h3><div class="L"><table id="N"><thead><tr><th data-sort="C">Produit</th><th data-sort="G">Stock Final</th><th data-sort="B">Date et Heure</th></tr></thead><tbody></tbody></table></div></div><div class="v"><h3>Stock Pro Lite (1H Pro, 2H Pro, 3H Pro)</h3><div class="L"><table id="O"><thead><tr><th data-sort="C">Produit</th><th data-sort="G">Stock Final</th><th data-sort="B">Date et Heure</th></tr></thead><tbody></tbody></table></div></div><div class="v"><h3>Stock Pro Journalier (1J Pro, 3J Pro, 7J Pro, 30J Pro)</h3><div class="L"><table id="P"><thead><tr><th data-sort="C">Produit</th><th data-sort="G">Stock Final</th><th data-sort="B">Date et Heure</th></tr></thead><tbody></tbody></table></div></div><div class="v"><h3>Stock Data (1G, 5G, 10G, 25G)</h3><div class="L"><table id="Q"><thead><tr><th data-sort="C">Produit</th><th data-sort="G">Stock Final</th><th data-sort="B">Date et Heure</th></tr></thead><tbody></tbody></table></div></div></div><div class="n"><button id="R" class="o">Détail des ventes</button> <button id="S" class="o">Analyse des ventes</button></div><div id="q"><h2>Détails des ventes</h2><div class="t"><input type="datetime-local" id="T"> <input type="datetime-local" id="U"> <button id="V">Filtrer</button></div><div id="m"><input type="text" id="W" placeholder="Rechercher Date/Heure"> <input type="text" id="X" placeholder="Rechercher Produit"> <input type="text" id="Y" placeholder="Rechercher SI"> <input type="text" id="Z" placeholder="Rechercher APP"> <input type="text" id="_" placeholder="Rechercher V"> <input type="text" id="aa" placeholder="Rechercher SF"> <input type="text" id="ab" placeholder="Rechercher PV"> <input type="text" id="ac" placeholder="Rechercher Total"></div><table id="ad"><thead><tr><th data-sort="B">Date et Heure</th><th data-sort="C">Produit</th><th data-sort="D">SI</th><th data-sort="E">APP</th><th data-sort="F">V</th><th data-sort="G">SF</th><th data-sort="H">PV (FCFA)</th><th data-sort="ae">Total (FCFA)</th></tr></thead><tbody></tbody></table></div><div id="p"><h2>Analyse des ventes</h2><p id="af"></p><p id="ag"></p><canvas id="i"></canvas><div class="r" id="ah"><h3>Analyse de la semaine</h3><p id="ai"></p><p id="aj"></p></div><div class="r" id="ak"><h3>Analyse du mois</h3><p id="al"></p><p id="am"></p></div><div class="r" id="an"><h3>Analyse des 3 derniers mois</h3><p id="ao"></p><p id="ap"></p></div></div></div><script>const aq={apiKey:"AIzaSyB6AUBnK_7Vy2ABWI2JMo3ebG_Sljr8XlY",authDomain:"cyber-campus-2706f.firebaseapp.com",databaseURL:"https://cyber-campus-2706f-default-rtdb.firebaseio.com",projectId:"cyber-campus-2706f",storageBucket:"cyber-campus-2706f.appspot.com",messagingSenderId:"719410601264",appId:"1:719410601264:web:44fd2e3757721866303cf5",measurementId:"G-CEEFJP5LYZ"};firebase.initializeApp(aq);const ar=firebase.database(),as=document.getElementById("j"),at=document.getElementById("w"),au=document.getElementById("z"),av=document.getElementById("A"),aw=document.getElementById("ad"),ax=document.getElementById("af"),ay=document.getElementById("ag"),az=document.getElementById("l"),aA=document.getElementById("S"),aB=document.getElementById("R"),aC=document.getElementById("p"),aD=document.getElementById("q");let aE,aF,aG=[],aH=[];document.getElementById("B").value=(new Date).toISOString().slice(0,16);const aI={"1H":100,"2H":200,"3H":250,"1J":300,"3J":600,"7J":1200,"30J":4000,"1G":100,"5G":400,"10G":700,"25G":1500,"1H Pro":250,"2H Pro":450,"3H Pro":600,"1J Pro":600,"3J Pro":1200,"7J Pro":2400,"30J Pro":8e3};function aJ(a){aF=a,at.style.display="none",au.style.display="block",az.textContent=`Utilisateur: ${a}`,aK(),aL(),aM()}function aN(){const a=parseInt(document.getElementById("D").value)||0,b=parseInt(document.getElementById("E").value)||0,c=parseInt(document.getElementById("F").value)||0;document.getElementById("G").value=a+b-c}function aO(){const a=document.getElementById("C").value;document.getElementById("H").value=aI[a]||0}function aK(){const a=aw.querySelector("tbody");a.innerHTML="",ar.ref("sales/"+aF).once("value").then(b=>{aG=[],b.forEach(b=>{const c=b.val();c.ae=(c.F*c.H).toFixed(2),aG.push(c)}),aP(aG),aQ(),aR(aw)})}function aL(){const a={M:document.getElementById("M"),N:document.getElementById("N"),O:document.getElementById("O"),P:document.getElementById("P"),Q:document.getElementById("Q")};Object.values(a).forEach(a=>{a.querySelector("tbody").innerHTML=""}),ar.ref("sales/"+aF).once("value").then(b=>{const c={};b.forEach(a=>{const b=a.val();(!c[b.C]||new Date(b.B)>new Date(c[b.C].B))&&(c[b.C]=b)}),Object.values(c).forEach(b=>{let c;["1H","2H","3H"].includes(b.C)?c=a.M:["1J","3J","7J","30J"].includes(b.C)?c=a.N:["1H Pro","2H Pro","3H Pro"].includes(b.C)?c=a.O:["1J Pro","3J Pro","7J Pro","30J Pro"].includes(b.C)?c=a.P:["1G","5G","10G","25G"].includes(b.C)&&(c=a.Q),c&&(d=c.querySelector("tbody").insertRow(),d.insertCell(0).textContent=b.C,d.insertCell(1).textContent=b.G,d.insertCell(2).textContent=new Date(b.B).toLocaleString())}),Object.values(a).forEach(a=>{aR(a)})})}function aP(a){const b=aw.querySelector("tbody");b.innerHTML="",a.forEach(a=>{const c=b.insertRow();c.insertCell(0).textContent=new Date(a.B).toLocaleString(),c.insertCell(1).textContent=a.C,c.insertCell(2).textContent=a.D,c.insertCell(3).textContent=a.E,c.insertCell(4).textContent=a.F,c.insertCell(5).textContent=a.G,c.insertCell(6).textContent=a.H,c.insertCell(7).textContent=a.ae})}function aQ(){const a=document.querySelectorAll("#m input");a.forEach(a=>{a.addEventListener("input",()=>{const b=aG.filter(b=>Object.keys(b).every(c=>{const d=document.getElementById(`search${c.charAt(0).toUpperCase()+c.slice(1)}`)?.value.toLowerCase()||"";return b[c].toString().toLowerCase().includes(d)}));aP(b),aM(b)})})}function aR(a){const b=a.querySelectorAll("th[data-sort]");b.forEach(b=>{b.addEventListener("click",()=>{const c=b.dataset.sort,d="ad"===a.id?aG:aH;d.sort((a,b)=>a[c]<b[c]?-1:a[c]>b[c]?1:0),"ad"===a.id?(aP(d),aM(d)):aS(d,a)})})}function aS(a,b){const c=b.querySelector("tbody");c.innerHTML="",a.forEach(a=>{const d=c.insertRow();d.insertCell(0).textContent=a.C,d.insertCell(1).textContent=a.G,d.insertCell(2).textContent=new Date(a.B).toLocaleString()})}function aM(a=aG){let b=0,c=0;const d={labels:[],sales:[],prices:[]};a.forEach(a=>{b+=a.F*a.H,c++,d.labels.push(new Date(a.B).toLocaleString()),d.sales.push(a.F),d.prices.push(a.H)});const e=b/c||0;ax.textContent=`Total des ventes: ${b.toFixed(2)} FCFA`,ay.textContent=`Moyenne des ventes par jour: ${e.toFixed(2)} FCFA`,aT(d),aU(a)}function aT(a){const b=document.getElementById("i").getContext("2d");aE&&aE.destroy(),aE=new Chart(b,{type:"line",data:{labels:a.labels,datasets:[{label:"Ventes",data:a.sales,borderColor:"rgb(0, 255, 255)",tension:.1},{label:"Prix de vente",data:a.prices,borderColor:"rgb(255, 99, 132)",tension:.1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgb(0, 255, 255)"}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgb(0, 255, 255)"}}},plugins:{legend:{labels:{color:"rgb(0, 255, 255)"}}}}})

function aU(a){const b=new Date,c=new Date(b.getTime()-6048e5),d=new Date(b.getTime()-2592e6),e=new Date(b.getTime()-7776e6),f=a.filter(a=>new Date(a.B)>=c),g=a.filter(a=>new Date(a.B)>=d),h=a.filter(a=>new Date(a.B)>=e);aV(f,"week"),aV(g,"month"),aV(h,"threeMonth")}function aV(a,b){const c=a.reduce((a,b)=>a+b.F*b.H,0),d=c/a.length||0;document.getElementById(`${b}TotalSales`).textContent=`Total des ventes: ${c.toFixed(2)} FCFA`,document.getElementById(`${b}AverageSales`).textContent=`Moyenne des ventes par jour: ${d.toFixed(2)} FCFA`}as.addEventListener("submit",function(a){a.preventDefault();const b=document.getElementById("x").value,c=document.getElementById("y").value;ar.ref("users/"+b).once("value").then(a=>{a.exists()?a.val().password===c?aJ(b):alert("Mot de passe incorrect"):ar.ref("users/"+b).set({password:c}).then(()=>{aJ(b)}).catch(a=>{console.error("Error creating user:",a),alert("Erreur lors de la création du compte")})})}),document.getElementById("C").addEventListener("change",function(){const a=this.value;ar.ref("sales/"+aF).orderByChild("C").equalTo(a).limitToLast(1).once("value").then(a=>{if(a.exists()){const b=Object.values(a.val())[0];document.getElementById("D").value=b.G||0}else document.getElementById("D").value=0}),aO()}),document.getElementById("F").addEventListener("input",aN),document.getElementById("E").addEventListener("input",aN),av.addEventListener("submit",function(a){a.preventDefault();const b={B:document.getElementById("B").value,C:document.getElementById("C").value,D:parseInt(document.getElementById("D").value)||0,E:parseInt(document.getElementById("E").value)||0,F:parseInt(document.getElementById("F").value)||0,G:parseInt(document.getElementById("G").value)||0,H:parseFloat(document.getElementById("H").value)||0};ar.ref("sales/"+aF).push(b).then(()=>{aK(),aL(),aM(),av.reset(),document.getElementById("B").value=(new Date).toISOString().slice(0,16)}).catch(a=>{console.error("Erreur lors de l'ajout de l'entrée :",a),alert("Une erreur est survenue lors de l'ajout de l'entrée.")})}),aA.addEventListener("click",function(){"none"===aC.style.display||""===aC.style.display?(aC.style.display="block",aD.style.display="none",this.textContent="Masquer l'analyse des ventes",aB.textContent="Détail des ventes"):(aC.style.display="none",this.textContent="Analyse des ventes")}),aB.addEventListener("click",function(){"none"===aD.style.display||""===aD.style.display?(aD.style.display="block",aC.style.display="none",this.textContent="Masquer le détail des ventes",aA.textContent="Analyse des ventes"):(aD.style.display="none",this.textContent="Détail des ventes")});const aW=document.getElementById("s"),aX=document.documentElement;let aY=!0;function aZ(a){a?(aX.classList.remove("g"),aW.textContent="🌙",aW.setAttribute("aria-label","Activer le mode clair")):(aX.classList.add("g"),aW.textContent="☀️",aW.setAttribute("aria-label","Activer le mode sombre")),aY=a}aW.addEventListener("click",()=>{aZ(!aY)}),document.getElementById("K").addEventListener("click",function(){const a=new Date(document.getElementById("I").value),b=new Date(document.getElementById("J").value);a_(a,b)}),document.getElementById("V").addEventListener("click",function(){const a=new Date(document.getElementById("T").value),b=new Date(document.getElementById("U").value),c=aG.filter(c=>{const d=new Date(c.B);return(!a||d>=a)&&(!b||d<=b)});aP(c),aM(c)});function a_(a,b){const c={M:document.getElementById("M"),N:document.getElementById("N"),O:document.getElementById("O"),P:document.getElementById("P"),Q:document.getElementById("Q")};Object.values(c).forEach(a=>{a.querySelector("tbody").innerHTML=""}),ar.ref("sales/"+aF).once("value").then(d=>{const e={};d.forEach(c=>{const d=c.val(),f=new Date(d.B);(!a||f>=a)&&(!b||f<=b)&&(!e[d.C]||f>new Date(e[d.C].B))&&(e[d.C]=d)}),Object.values(e).forEach(a=>{let b;["1H","2H","3H"].includes(a.C)?b=c.M:["1J","3J","7J","30J"].includes(a.C)?b=c.N:["1H Pro","2H Pro","3H Pro"].includes(a.C)?b=c.O:["1J Pro","3J Pro","7J Pro","30J Pro"].includes(a.C)?b=c.P:["1G","5G","10G","25G"].includes(a.C)&&(b=c.Q),b&&(d=b.querySelector("tbody").insertRow(),d.insertCell(0).textContent=a.C,d.insertCell(1).textContent=a.G,d.insertCell(2).textContent=new Date(a.B).toLocaleString())}),Object.values(c).forEach(a=>{aR(a)})})}aK(),aL(),aC.style.display="none",aD.style.display="none",aK(),aL(),aM();const ba=localStorage.getItem("darkTheme");null!==ba&&aZ("true"===ba);</script></body></html>
